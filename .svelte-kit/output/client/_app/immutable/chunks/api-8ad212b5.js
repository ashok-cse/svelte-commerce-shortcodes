import{l as w}from"./store-9c7a7cc1.js";import{i as j}from"./website-53ccb8f7.js";let g;const a=async({method:i,path:e,params:n,data:s,token:m,headers:c})=>{var h,y;if(e.includes(".png")||e.includes(".jpg")||e.includes(".svg")||e.includes(".json")||e.includes(".css")||e.includes("undefined"))return;const d="http://localhost:3000";let r=d,T=j;c&&c.get("cookie")&&c.get("cookie").includes("store")&&(r=c.get("origin")||c.get("host"),r==="localhost:3000"?r="http://localhost:3000":r="https://"+r);let p=new URL(e,d);e.includes("/api/")||(p=new URL("api/"+e,r)),p.searchParams.get("domain"),p.searchParams.get("store");const f={method:i};if(f.headers=c||{Cache:"no-cache"},s){s.store=T;const t=(s==null?void 0:s.files)&&((h=s==null?void 0:s.files[0])==null?void 0:h.type);if(!(t=="image/jpeg"||t=="image/gif"||t=="image/png"||t=="image/ico"||t=="image/webp"||t=="application/pdf"||t=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||t=="application/msword"||t=="application/vnd.openxmlformats-officedocument.wordprocessingml.document"))f.headers["Content-Type"]="application/json",f.body=JSON.stringify(s);else{const o=new FormData;if(s&&s.files)for(let u of s.files)o.append("files",u);for(let u in s)u!=="files"&&o.append(u,s[u]);f.body=o}}m&&(f.headers.Authorization=`Bearer ${m}`),n||(n={}),n&&Object.keys(n).forEach(t=>p.searchParams.append(t,n[t]));try{const t=p.toString();L();let o=await fetch(t,f);P();const l=((y=o.headers.get("content-type"))==null?void 0:y.includes("application/json"))?await o.json():await o.text();if((l==null?void 0:l.status)>399)throw{status:l.status,message:l};if((o==null?void 0:o.status)>399)throw{status:o.status,message:l};return l}catch(t){throw t}},E=(i,e)=>a({method:"GET",path:i,headers:e}),b=(i,e)=>a({method:"DELETE",path:i,headers:e}),I=(i,e,n)=>a({method:"POST",path:i,data:e,headers:n}),U=(i,e,n)=>a({method:"PUT",path:i,data:e,headers:n}),L=async()=>{clearTimeout(g),g=setTimeout(()=>{w.set(!0)},5e3)},P=async()=>{clearTimeout(g),w.set(!1)};export{U as a,b as d,E as g,I as p};
